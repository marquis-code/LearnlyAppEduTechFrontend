import{z as I,G as Y,M as P,r as A,N as Q,b as L,g as U,O as q,P as X,Q as Z,A as V,u as C,H as J}from"./entry.3affc06b.js";import{a as ee}from"./auth.a92d66c7.js";import{u as te}from"./vuex.esm-bundler.e6377e65.js";import{S as x}from"./sweetalert2.all.d4f02120.js";function ne(e){return q()?(X(e),!0):!1}function _(e){return typeof e=="function"?e():I(e)}const re=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const oe=Object.prototype.toString,se=e=>oe.call(e)==="[object Object]",ae=()=>{};function ue(e,t){function n(...s){return new Promise((l,d)=>{Promise.resolve(e(()=>t.apply(this,s),{fn:t,thisArg:this,args:s})).then(l).catch(d)})}return n}const R=e=>e();function ie(e=R){const t=A(!0);function n(){t.value=!1}function s(){t.value=!0}const l=(...d)=>{t.value&&e(...d)};return{isActive:Q(t),pause:n,resume:s,eventFilter:l}}function le(e){return e||U()}function ce(e,t,n={}){const{eventFilter:s=R,...l}=n;return L(e,ue(s,t),l)}function fe(e,t,n={}){const{eventFilter:s,...l}=n,{eventFilter:d,pause:m,resume:w,isActive:b}=ie(s);return{stop:ce(e,t,{...l,eventFilter:d}),pause:m,resume:w,isActive:b}}function de(e,t=!0,n){le()?Y(e,n):t?e():P(e)}function pe(e){var t;const n=_(e);return(t=n==null?void 0:n.$el)!=null?t:n}const k=re?window:void 0;function z(...e){let t,n,s,l;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,s,l]=e,t=k):[t,n,s,l]=e,!t)return ae;Array.isArray(n)||(n=[n]),Array.isArray(s)||(s=[s]);const d=[],m=()=>{d.forEach(a=>a()),d.length=0},w=(a,i,y,g)=>(a.addEventListener(i,y,g),()=>a.removeEventListener(i,y,g)),b=L(()=>[pe(t),_(l)],([a,i])=>{if(m(),!a)return;const y=se(i)?{...i}:i;d.push(...n.flatMap(g=>s.map(h=>w(a,g,h,y))))},{immediate:!0,flush:"post"}),o=()=>{b(),m()};return ne(o),o}const T=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},F="__vueuse_ssr_handlers__",ge=ye();function ye(){return F in T||(T[F]=T[F]||{}),T[F]}function me(e,t){return ge[e]||t}function ve(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const we={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},B="vueuse-storage";function H(e,t,n,s={}){var l;const{flush:d="pre",deep:m=!0,listenToStorageChanges:w=!0,writeDefaults:b=!0,mergeDefaults:o=!1,shallow:a,window:i=k,eventFilter:y,onError:g=r=>{console.error(r)},initOnMounted:h}=s,p=(a?Z:A)(typeof t=="function"?t():t);if(!n)try{n=me("getDefaultStorage",()=>{var r;return(r=k)==null?void 0:r.localStorage})()}catch(r){g(r)}if(!n)return p;const f=_(t),W=ve(f),O=(l=s.serializer)!=null?l:we[W],{pause:D,resume:j}=fe(p,()=>G(p.value),{flush:d,deep:m,eventFilter:y});i&&w&&de(()=>{z(i,"storage",N),z(i,B,$),h&&N()}),h||N();function M(r,c){i&&i.dispatchEvent(new CustomEvent(B,{detail:{key:e,oldValue:r,newValue:c,storageArea:n}}))}function G(r){try{const c=n.getItem(e);if(r==null)M(c,null),n.removeItem(e);else{const v=O.write(r);c!==v&&(n.setItem(e,v),M(c,v))}}catch(c){g(c)}}function K(r){const c=r?r.newValue:n.getItem(e);if(c==null)return b&&f!=null&&n.setItem(e,O.write(f)),f;if(!r&&o){const v=O.read(c);return typeof o=="function"?o(v,f):W==="object"&&!Array.isArray(v)?{...f,...v}:v}else return typeof c!="string"?c:O.read(c)}function N(r){if(!(r&&r.storageArea!==n)){if(r&&r.key==null){p.value=f;return}if(!(r&&r.key!==e)){D();try{(r==null?void 0:r.newValue)!==O.write(p.value)&&(p.value=K(r))}catch(c){g(c)}finally{r?P(j):j()}}}}function $(r){N(r.detail)}return p}const u={user:A({}),token:A("")},E={user:H("user",{}),token:H("token","")},he=V();L(u.user,e=>{Object.keys(e).forEach(t=>{E.user.value[t]=e[t]})},{deep:!0});u.user.value=E.user.value,u.token.value=E.token.value;const S=A({email:"",password:""}),Ee=()=>{const e=te(),t=A(!1),n=async()=>{var o,a,i,y,g,h;t.value=!0;try{const p={email:S.value.email,password:S.value.password},f=await ee.login(p);return u.user.value=(a=(o=f.data)==null?void 0:o.data)==null?void 0:a.user,E.token.value=(y=(i=f.data)==null?void 0:i.data)==null?void 0:y.token,u.token.value=(h=(g=f.data)==null?void 0:g.data)==null?void 0:h.token,J().$toast.success("Welcome back.",{autoClose:5e3,dangerouslyHTMLString:!0}),V().push("/dashboard"),e.commit("user/SET_USER",f.data.data.user),e.commit("user/SET_TOKEN",f.data.data.token),f.data}catch(p){return typeof p.response<"u"&&J().$toast.error("Something went wrong!",{autoClose:5e3,dangerouslyHTMLString:!0}),p}finally{t.value=!1}},s=()=>{x.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Nah, Just Kidding!",confirmButtonText:"Yes, Logout!"}).then(o=>{o.value?(localStorage.clear(),u.user.value=null,he.push("/signup")):x.fire("Cancelled","Action was cancelled","info")})},l=C({get:()=>{var o,a;return((a=(o=u==null?void 0:u.user)==null?void 0:o.value)==null?void 0:a.id)??""},set:()=>{}}),d=C({get:()=>{var o,a;return(o=u.token)!=null&&o.value?((a=u==null?void 0:u.user)==null?void 0:a.value)!=null||void 0||{}:!1},set:()=>{}}),m=C({get:()=>{var o,a,i;return(o=u.token)!=null&&o.value?(((a=u==null?void 0:u.user)==null?void 0:a.value)!=null,(i=u==null?void 0:u.user)==null?void 0:i.value):!1},set:()=>{}}),w=C(()=>!!(S.value.email&&S.value.password));return{handleLogin:n,setLoginData:o=>{S.value.email=o.email,S.value.password=o.password},localStorageData:E,loginPayload:S,loading:t,isFormEmpty:w,logOut:s,isLoggedIn:d,id:l,user:m}};export{Ee as u};
